// scripts.js - JavaScript otimizado para o Instituto HANIEL

document.addEventListener('DOMContentLoaded', function() {
    // Elementos do DOM
    const header = document.querySelector('.header');
    const hamburger = document.querySelector('.hamburger');
    const navbar = document.querySelector('.navbar');
    const navLinks = document.querySelectorAll('.nav-link');
    const backToTopBtn = document.getElementById('back-to-top');
    const contactForm = document.getElementById('contact-form');
    
    // Efeito de scroll no header
    function handleScroll() {
        if (window.scrollY > 50) {
            header.classList.add('scrolled');
        } else {
            header.classList.remove('scrolled');
        }
        
        // Botão "voltar ao topo"
        if (window.scrollY > 300) {
            backToTopBtn.classList.add('visible');
        } else {
            backToTopBtn.classList.remove('visible');
        }
    }
    
    // Menu hamburger
    function toggleMenu() {
        togglhamburger.classList.e('hamburger--active');
        navbar.classList.toggle('active');
        document.body.classList.toggle('no-scroll');
    }
    
    // Fechar menu ao clicar em um link
    function closeMenu() {
        hamburger.classList.remove('hamburger--active');
        navbar.classList.remove('active');
        document.body.classList.remove('no-scroll');
    }
    
    // Scroll suave para âncoras
    function smoothScroll(e) {
        e.preventDefault();
        
        const targetId = this.getAttribute('href');
        if (targetId === '#') return;
        
        const targetElement = document.querySelector(targetId);
        if (targetElement) {
            const headerHeight = header.offsetHeight;
            const targetPosition = targetElement.offsetTop - headerHeight;
            
            window.scrollTo({
                top: targetPosition,
                behavior: 'smooth'
            });
            
            // Fechar menu mobile se estiver aberto
            if (navbar.classList.contains('active')) {
                closeMenu();
            }
        }
    }
    
    // Validação do formulário
    function handleFormSubmit(e) {
        e.preventDefault();
        
        // Validação básica
        const nome = document.ElemegetntById('nome');
        const email = document.getElementById('email');
        const mensagem = document.getElementById('mensagem');
        let isValid = true;
        
        if (nome.value.trim() === '') {
            nome.classList.add('error');
            isValid = false;
        } else {
            nome.classList.remove('error');
        }
        
        if (email.value.trim() === '' || !email.value.includes('@')) {
            email.classList.add('error');
            isValid = false;
        } else {
            email.classList.remove('error');
        }
        
        if (mensagem.value.trim() === '') {
            mensagem.classList.add('error');
            isValid = false;
        } else {
            mensagem.classList.remove('error');
        }
        
        if (isValid) {
            // Simular envio (substituir por código real de envio)
            const formData = new FormData(contactForm);
            fetch(contactForm.action, {
                method: 'POST',
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            })
            .then(response => {
                if (response.ok) {
                    alert('Mensagem enviada com sucesso!');
                    contactForm.reset();
                } else {
                    throw new Error('Erro ao enviar mensagem');
                }
            })
            .catch(error => {
                alert('Ocorreu um erro ao enviar sua mensagem. Por favor, tente novamente mais tarde.');
                console.error('Error:', error);
            });
        }
    }
    
    // Event Listeners
    window.addEventListener('scroll', handleScroll);
    hamburger.addEventListener('click', toggleMenu);
    backToTopBtn.addEventListener('click', () => {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    });
    
    navLinks.forEach(link => {
        link.addEventListener('click', smoothScroll);
    });
    
    if (contactForm) {
        contactForm.addEventListener('submit', handleFormSubmit);
    }
    
    // Inicializações
    handleScroll();
    
    // Lazy loading para imagens
    if ('loading' in HTMLImageElement.prototype) {
        const lazyImages = document.querySelectorAll('img[loading="lazy"]');
        lazyImages.forEach(img => {
            img.src = img.dataset.src;
        });
    } else {
        // Fallback para browsers sem suporte a lazy loading nativo
        const lazyLoadObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    img.src = img.dataset.src;
                    observer.unobserve(img);
                }
            });
        });
        
        const lazyImages = document.querySelectorAll('img[loading="lazy"]');
        lazyImages.forEach(img => {
            lazyLoadObserver.observe(img);
        });
    }
    
    // Máscara para telefone
    const telefoneInput = document.getElementById('telefone');
    if (telefoneInput) {
        telefoneInput.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/^(\d{2})(\d)/g, '($1) $2');
            value = value.replace(/(\d)(\d{4})$/, '$1-$2');
            e.target.value = value;
        });
    }
});

// Dados dos cursos (pode ser substituído por uma chamada API no futuro)
const cursosData = {
  "curso-detalhe-1": {
    titulo: "Introdução à Tecnologia",
    imagem: "img/curso-tecnologia.jpg",
    duracao: "40 horas",
    nivel: "Iniciante",
    categoria: "Tecnologia",
    descricao: "Este curso oferece uma introdução abrangente aos conceitos fundamentais de tecnologia da informação. Os participantes aprenderão sobre hardware, software, sistemas operacionais, redes básicas e segurança digital. O curso é ideal para quem deseja adquirir conhecimentos essenciais para o mercado de trabalho atual.",
    conteudo: [
      "Conceitos básicos de hardware e software",
      "Sistemas operacionais: Windows e Linux",
      "Pacote Office: Word, Excel e PowerPoint",
      "Internet e navegação segura",
      "Redes sociais e comunicação digital",
      "Segurança da informação básica"
    ],
    preRequisitos: "Nenhum conhecimento prévio necessário. Acesso a um computador com internet é recomendado.",
    investimento: "Grátis para membros da comunidade"
  },
  "curso-detalhe-2": {
    titulo: "Arte e Cultura Comunitária",
    imagem: "img/curso-artes.jpg",
    duracao: "60 horas",
    nivel: "Intermediário",
    categoria: "Artes",
    descricao: "Este curso explora o potencial transformador da arte nas comunidades. Os participantes aprenderão técnicas artísticas diversas e como aplicá-las em projetos culturais comunitários. O curso inclui workshops práticos e desenvolvimento de projetos reais em parceria com organizações locais.",
    conteudo: [
      "História da arte comunitária",
      "Técnicas de pintura mural",
      "Teatro comunitário",
      "Danças tradicionais",
      "Produção cultural",
      "Elaboração de projetos artísticos"
    ],
    preRequisitos: "Interesse em arte e cultura. Não é necessário experiência prévia.",
    investimento: "R$ 150,00 ou bolsas integrais disponíveis"
  },
  "curso-detalhe-3": {
    titulo: "Assistência Social Básica",
    imagem: "img/curso-assistencia.jpg",
    duracao: "80 horas",
    nivel: "Intermediário",
    categoria: "Assistência Social",
    descricao: "Curso voltado para capacitação de agentes comunitários e interessados em atuar na área social. Aborda conceitos fundamentais de direitos humanos, políticas públicas e técnicas de atendimento e acolhimento.",
    conteudo: [
      "História das políticas sociais no Brasil",
      "Sistema Único de Assistência Social (SUAS)",
      "Direitos humanos e cidadania",
      "Técnicas de entrevista e acolhimento",
      "Encaminhamentos e rede de proteção",
      "Elaboração de projetos sociais"
    ],
    preRequisitos: "Ensino médio completo. Disponibilidade para atividades práticas.",
    investimento: "Grátis para moradores da região"
  },
  "curso-detalhe-4": {
    titulo: "Programação Web Básica",
    imagem: "img/curso-programacao.jpg",
    duracao: "120 horas",
    nivel: "Avançado",
    categoria: "Tecnologia",
    descricao: "Curso introdutório às tecnologias web essenciais para iniciar uma carreira como desenvolvedor front-end. Os alunos aprenderão HTML, CSS e JavaScript através de projetos práticos e receberão orientação para montar seu portfólio.",
    conteudo: [
      "HTML5 e semântica web",
      "CSS3 e design responsivo",
      "JavaScript básico",
      "Bootstrap e frameworks CSS",
      "Git e controle de versão",
      "Projeto final: portfólio pessoal"
    ],
    preRequisitos: "Conhecimentos básicos de informática. Lógica de programação é um diferencial.",
    investimento: "R$ 300,00 ou 3x de R$ 100,00"
  }
};

// Função para abrir o modal
function abrirModalCurso(cursoId) {
  const curso = cursosData[cursoId];
  if (!curso) return;
  
  // Preencher os dados do modal
  document.getElementById('modalCursoTitulo').textContent = curso.titulo;
  document.getElementById('modalCursoImagem').src = curso.imagem;
  document.getElementById('modalCursoImagem').alt = curso.titulo;
  document.getElementById('modalCursoDuracao').innerHTML = `<i class="far fa-clock"></i> ${curso.duracao}`;
  document.getElementById('modalCursoNivel').textContent = curso.nivel;
  document.getElementById('modalCursoCategoria').innerHTML = `<i class="fas fa-tag"></i> ${curso.categoria}`;
  document.getElementById('modalCursoDescricao').textContent = curso.descricao;
  document.getElementById('modalCursoPreRequisitos').textContent = curso.preRequisitos;
  document.getElementById('modalCursoInvestimento').textContent = curso.investimento;
  
  // Preencher conteúdo programático
  const conteudoList = document.getElementById('modalCursoConteudo');
  conteudoList.innerHTML = '';
  curso.conteudo.forEach(item => {
    const li = document.createElement('li');
    li.textContent = item;
    conteudoList.appendChild(li);
  });
  
  // Mostrar o modal
  const modal = document.getElementById('cursoModal');
  modal.classList.add('active');
  document.body.style.overflow = 'hidden';
}

// Função para fechar o modal
function fecharModalCurso() {
  const modal = document.getElementById('cursoModal');
  modal.classList.remove('active');
  document.body.style.overflow = 'auto';
}

// Event listeners para os botões "Saiba mais"
document.addEventListener('DOMContentLoaded', function() {
  // Fechar modal ao clicar no botão X
  document.querySelector('.modal__close').addEventListener('click', fecharModalCurso);
  
  // Fechar modal ao clicar fora do conteúdo
  document.getElementById('cursoModal').addEventListener('click', function(e) {
    if (e.target === this) {
      fecharModalCurso();
    }
  });
  
  // Adicionar evento aos botões "Saiba mais"
  document.querySelectorAll('[href^="#curso-detalhe-"]').forEach(btn => {
    btn.addEventListener('click', function(e) {
      e.preventDefault();
      const cursoId = this.getAttribute('href').substring(1);
      abrirModalCurso(cursoId);
    });
  });
});
